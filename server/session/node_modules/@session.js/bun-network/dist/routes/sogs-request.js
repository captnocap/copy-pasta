import _ from 'lodash';
import { SessionFetchError, SessionFetchErrorCode } from '@session.js/errors';
export async function sogsRequest({ host, endpoint, method, body, headers, }) {
    let response;
    try {
        response = await fetch(host + endpoint, {
            method,
            body: body || undefined,
            headers,
        });
    }
    catch (e) {
        throw new SessionFetchError({ code: SessionFetchErrorCode.FetchFailed, message: (e instanceof Error ? e.message : 'Unknown fetch error') });
    }
    let responseBody;
    try {
        responseBody = await response.json();
    }
    catch (e) {
        throw new SessionFetchError({ code: SessionFetchErrorCode.InvalidResponse, message: 'Failed to parse JSON response for ' + host + endpoint + ': ' + response.status });
    }
    return responseBody;
}
